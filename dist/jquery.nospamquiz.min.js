/**
 * jquery.nospamquiz.js - A simple jQuery plugin to prevent spammers.
 * @version v0.1.0
 * @link https://github.com/gormus/jquery.nospamquiz.js#readme
 * @license GPL-3.0
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(p){var i=0,n={init:function(e,t){var n;return this.el=t,this.$el=p(t),this.name="nospamquiz",this.defaults={headlineMarkup:"<h2></h2>",headline:"Quiz",introMarkup:"<p></p>",intro:"Please answer the following questions to enable the form.",questions:[],failureMarkup:"<p></p>",failure:"You must answer all questions correctly.",prize:this.$el.next(),onComplete:null},this.instanceId=i++,n=this.$el.data(this.name)||{},this.options=p.extend({},this.defaults,e,n),"string"==typeof this.options.prize&&(this.options.prize=p(this.options.prize)),this._build(),this},_build:function(){var e=this.el,o=this.$el,r=this.options,u=this.name,t=this.instanceId;r.prize.hide();var a=r.questions.map(function(e){return e.correctAnswer}).join(""),s=u+location.pathname+t;if(localStorage.getItem(s)!==a&&0!==r.questions.length||(o.hide(),r.prize.show()),r.headline){var n=p(r.headlineMarkup).text(r.headline);o.append(n)}if(r.intro){var i=p(r.introMarkup).text(r.intro);o.append(i)}var l=document.createElement("dl");r.questions.forEach(function(e,s){var t=document.createElement("dt"),n=document.createElement("dd");l.appendChild(t).textContent=e.question,l.appendChild(n),e.choices.map(function(e,t){return e&&(n=e,i=u+"-"+s,o=t,r=document.createElement("label"),a=r.appendChild(document.createElement("input")),r.appendChild(document.createTextNode(n)),a.type="radio",a.name=i,a.value=o,r);var n,i,o,r,a}).sort(function(){return.5-Math.random()}).forEach(function(e){e&&n.appendChild(e)})});var h=p(r.failureMarkup).text(r.failure);e.appendChild(l),e.addEventListener("change",function(){var n=r.questions.map(function(e,t){return l.querySelector('input[name="'+u+"-"+t+'"]:checked')}),e=r.questions.every(function(e,t){return n[t]&&Number(n[t].value)===Number(e.correctAnswer)}),t=!e&&n.filter(Boolean).length===r.questions.length,i=r.onComplete;e?(localStorage.setItem(s,a),o.hide("slow"),r.prize.show("slow"),p.isFunction(i)&&i.call(this)):t&&o.append(h)})}};p.fn.nospamquiz=function(t){if(this.length)return this.each(function(){var e=Object.create(n);e.init(t,this),p.data(this,"nospamquiz",e)})}});